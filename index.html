<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gartic Room Finder</title>

<style>
body{margin:0;background:#111;color:#eee;font-family:sans-serif;text-align:center}
h2{color:#ff4444}
select{padding:8px 14px;border-radius:20px;border:1px solid #444;background:#222;color:#fff}
#rooms{display:flex;flex-wrap:wrap;justify-content:center;gap:12px;margin:15px}
.room{
  background:#1a1a1a;border-radius:12px;padding:12px;width:180px;
  box-shadow:0 0 10px rgba(255,0,0,.4)
}
.room img{width:32px}
.btn{
  display:block;margin-top:6px;padding:5px;border-radius:6px;
  background:#222;color:white;text-decoration:none;font-size:13px
}
.btn:hover{background:#ff0000}
#info{margin-top:10px;color:#aaa}
</style>
</head>

<body>

<h2>Gartic Otaqlar</h2>

<select id="lang">
<option value="23" selected>Azərbaycanca</option>
<option value="2">English</option>
<option value="8">Türkçe</option>
<option value="3">Español</option>
<option value="4">Français</option>
<option value="6">Deutsch</option>
</select>

<div id="info">Yüklənir...</div>
<div id="rooms"></div>

<script>
const roomsDiv = document.getElementById("rooms");
const info = document.getElementById("info");
const langSel = document.getElementById("lang");

async function loadRooms(lang){
  roomsDiv.innerHTML="";
  info.innerText="Yüklənir...";

  try{
    const r = await fetch(`https://gartic.io/req/list?search=&language[]=${lang}`);
    const data = await r.json();
    const active = data.filter(x=>x.quant>0);

    if(active.length===0){
      info.innerText="Bu dildə otaq yoxdur.";
      return;
    }

    let totalUsers = 0;

    for(const room of active){
      totalUsers += room.quant;

      const d = document.createElement("div");
      d.className="room";

      d.innerHTML = `
        <h4>${room.id.slice(1)}</h4>
        <img src="https://gartic.io/static/images/subjects/${room.subject}.svg">
        <p>${room.quant} / ${room.max}</p>
        <a class="btn" target="_blank" href="https://gartic.io/${room.code}">JOIN</a>
        <a class="btn" target="_blank" href="https://gartic.io/${room.code}/viewer">VIEWER</a>
      `;

      roomsDiv.appendChild(d);
    }

    info.innerText = `Otaq: ${active.length} | User: ${totalUsers}`;

  }catch(e){
    console.error(e);
    info.innerText="Xəta oldu (network / CORS).";
  }
}

langSel.onchange = ()=>loadRooms(langSel.value);
loadRooms("23");
</script>

</body>
</html>
